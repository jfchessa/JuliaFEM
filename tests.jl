
using LinearAlgebra
using StructuralElements: mat1_cmat, gradshape2d!,
                         tria3_kmat!, tria3_bmat!,
                         tria6_kmat!, tria6_bmat!,
                         quad4_kmat!, quad4_bmat!,
                         quad8_kmat!, quad8_bmat!,
                         tetra4_kmat!, tetra4_bmat!,
                         tetra10_kmat!, tetra10_bmat!,
                         hexa8_kmat!, hexa8_bmat!,
                         hexa20_kmat!, hexa20_bmat!
 
E = 10e6;
nu = .3;
thk = 0.25;
cmat = mat1_cmat(E, nu, "PSTRESS");

print("***** Validating gradshape2d! ******\n")
coord = [0.0 0.0; 2.0 0.2; 0.3 1.0]';
dN = [-1.0 -1.0; 1.0 0.0; 0.0 1.0];
gradshape2d!(dN, coord, 3);
check =  [-0.412371134020619  -0.876288659793815;
        0.515463917525773  -0.154639175257732;
        -0.103092783505155   1.030927835051547];
print(norm(dN-check),"\n")
# -------------------

coord = [0.0 0.0; 2.0 0.2; 2.1 1.5; -.1 1.2]';
xi = [.1, .2];
dN = [-0.200000000000000  -0.225000000000000;
        0.200000000000000  -0.275000000000000;
        0.300000000000000   0.275000000000000;
        -0.300000000000000   0.225000000000000]
check = [  -0.144845748683220  -0.357411587659895;
        0.242663656884876  -0.440180586907449;
                0.229495861550038   0.436418359668924;
-0.327313769751693   0.361173814898420];
gradshape2d!(dN, coord, 4);
print(norm(dN-check),"\n")
# -------------------

print("***** Validating TRIA3 ******\n")
coord = [0.0 0.0; 2.0 0.2; 0.3 1.0]';
ke = zeros(6,6);
be = zeros(3,6);
jac = tria3_bmat!(be, coord);
check = [
    -0.412371134020619                   0   0.515463917525773                   0  -0.103092783505155                   0;
                     0  -0.876288659793814                   0  -0.154639175257732                   0   1.030927835051547;
    -0.876288659793814  -0.412371134020619  -0.154639175257732   0.515463917525773   1.030927835051547  -0.103092783505155];
print("b-matrix: ", norm(be-check),"\n")
print("b-matrix jac: ", norm(jac-1.94),"\n")

tria3_kmat!(ke, coord, cmat, thk);
check = [ 1.169352554661833   0.625920471281296  -0.440056077942676  -0.370312677013708  -0.729296476719157  -0.255607794267588;
0.625920471281296   2.204882746119859  -0.301631358332389   0.162852611306220  -0.324289112948907  -2.367735357426079;
-0.440056077942676  -0.301631358332389   0.730358558966806  -0.138070692194404  -0.290302481024131   0.439702050526793;
-0.370312677013708   0.162852611306220  -0.138070692194404   0.311544125977116   0.508383369208111  -0.474396737283335;
-0.729296476719157  -0.324289112948907  -0.290302481024131   0.508383369208111   1.019598957743288  -0.184094256259205;
-0.255607794267588  -2.367735357426079   0.439702050526793  -0.474396737283335  -0.184094256259205   2.842132094709414]*1.0e6;
print("k-matrix: ", norm(ke-check),"\n")


print("***** Validating TRIA6 ******\n")
coord = [0.0 0.0; 2.0 0.2; 0.3 1.0; 1.0 .99; 1.16 0.6; 0.16 0.5]';
ke = zeros(12,12);
be = zeros(3,12);
xi = [0.2, 0.3];
jac = tria6_bmat!(be, coord, xi);
check = [5.59003376836725	0	-0.328557086793830	0	-1.44656384046728	0	7.75759788263210	0	-3.81491284110614	0	-7.75759788263211	0;
    0	-9.60573149584740	0	0.360500136898786	0	2.28164643606826	0	-11.2895865656658	0	6.96358492288035	0	11.2895865656658;
    -9.60573149584740	5.59003376836725	0.360500136898786	-0.328557086793830	2.28164643606826	-1.44656384046728	-11.2895865656658	7.75759788263210	6.96358492288035	-3.81491284110614	11.2895865656658	-7.75759788263211];
print("b-matrix: ", norm(be-check),"\n")
print("b-matrix jac: ", norm(jac-0.175312),"\n")
tria6_kmat!(ke, coord, cmat, thk);
check = [26438797.1163797	-13059177.0352671	-1209445.70638025	678137.070107810	6971368.42742972	-3187921.33900524	20764831.9194822	-9944261.40186488	-10699126.4901086	5196222.38936064	-42266425.2668029	20317000.3166688;
    -13059177.0352671	28136193.5952293	655243.297214029	-1072270.37801509	-3165027.56611146	8004439.31496424	-9852686.31028980	20700683.0067869	5196222.38936064	-11592119.0667038	20225425.2250937	-44176926.4722615;
    -1209445.70638025	655243.297214029	-1021744.85933055	-197754.721979690	-494489.149153390	-59725.5509901306	-1913412.73297178	-235833.855923902	2190833.23256366	620682.452624359	2448259.21527232	-782611.620944666;
    678137.070107810	-1072270.37801509	-197754.721979690	-377545.825997416	-82619.3238839019	-244311.116076257	-327408.947499027	-1718295.20931302	712257.544199485	1590436.18116992	-782611.620944676	1821986.34823187;
    6971368.42742972	-3165027.56611146	-494489.149153390	-82619.3238839019	3959104.55803637	-1270609.72163768	3793978.04224280	-2497213.25016168	-1807512.30235303	2241672.45704664	-12422449.5762025	4773797.40474808;
    -3187921.33900524	8004439.31496424	-59725.5509901306	-244311.116076257	-1270609.72163768	8283055.10261802	-2497213.25016167	1599244.61168969	2150097.36547152	-804801.726262518	4865372.49632320	-16837626.1869332;
    20764831.9194822	-9852686.31028980	-1913412.73297178	-327408.947499027	3793978.04224280	-2497213.25016167	14683576.9434962	-8560160.65787212	-5656008.65636566	5284096.17933545	-31672965.5158838	15953372.9864872;
    -9944261.40186488	20700683.0067869	-235833.855923902	-1718295.20931302	-2497213.25016168	1599244.61168969	-8560160.65787212	11661129.6474657	5284096.17933544	-3417265.55508093	15953372.9864871	-28825496.5015484;
    -10699126.4901086	5196222.38936064	2190833.23256366	712257.544199485	-1807512.30235303	2150097.36547152	-5656008.65636566	5284096.17933544	726307.072544202	-4129069.13109322	15245507.1437194	-9213604.34727386;
    5196222.38936064	-11592119.0667038	620682.452624359	1590436.18116992	2241672.45704664	-804801.726262518	5284096.17933545	-3417265.55508094	-4129069.13109322	-1285145.80325978	-9213604.34727388	15508895.9701372;
    -42266425.2668029	20225425.2250937	2448259.21527232	-782611.620944676	-12422449.5762025	4865372.49632320	-31672965.5158838	15953372.9864871	15245507.1437194	-9213604.34727387	68668073.9998974	-31047954.7396855;
    20317000.3166688	-44176926.4722615	-782611.620944666	1821986.34823187	4773797.40474808	-16837626.1869332	15953372.9864872	-28825496.5015484	-9213604.34727386	15508895.9701372	-31047954.7396855	72509166.8423740];
print("k-matrix: ", norm(ke-check),"\n")


print("***** Validating QUAD4 ******\n")
coord = [0.0 0.0; 2.0 0.2; 2.1 0.9; 0.3 1.0]';
ke = zeros(8, 8);
be = zeros(3,8);
xi = [0.2, 0.3];
jac = quad4_bmat!(be, coord, xi);
check = [ -0.185970636215334	0	0.189233278955954	0	0.345840130505710	0	-0.349102773246329	0;
    0	-0.446982055464927	0	-0.773246329526917	0	0.655791190864600	0	0.564437194127243;
    -0.446982055464927	-0.185970636215334	-0.773246329526917	0.189233278955954	0.655791190864600	0.345840130505710	0.564437194127243	-0.349102773246329];
print("b-matrix: ", norm(be-check),"\n")
print("b-matrix jac: ", norm(jac-0.3831250),"\n")
quad4_kmat!(ke, coord, cmat, thk);
check = [887334.350859084	363118.475377253	-33683.3905733606	8370.51393463773	-430799.460927034	-401445.568546334	-422851.499358690	29956.5792344430;
    363118.475377253	1684620.66398554	77051.8326159564	912521.595798976	-401445.568546334	-794731.054598878	-38724.7394468756	-1802411.20518564;
    -33683.3905733606	77051.8326159564	1382143.24679572	-557185.616384314	-624158.222478334	-21824.6038762574	-724301.633744029	501958.387644615;
    8370.51393463773	912521.595798976	-557185.616384314	2739467.67025696	46856.7148050613	-2194803.47389157	501958.387644615	-1457185.79216436;
    -430799.460927034	-401445.568546334	-624158.222478334	46856.7148050613	1128183.46602009	342898.670319549	-73225.7826147193	11690.1834217234;
    -401445.568546334	-794731.054598878	-21824.6038762574	-2194803.47389157	342898.670319549	2154089.98547300	80371.5021030421	835444.543017454;
    -422851.499358690	-38724.7394468756	-724301.633744029	501958.387644615	-73225.7826147193	80371.5021030421	1220378.91571744	-543605.150300782;
    29956.5792344430	-1802411.20518564	501958.387644615	-1457185.79216436	11690.1834217234	835444.543017454	-543605.150300782	2424152.45433255 ];
print("k-matrix: ", norm(ke-check),"\n")

print("***** Validating QUAD8 ******\n")
coord = [0.0 0.0; 2.0 0.2; 2.1 0.9; 0.3 1.0; 1.0 .1; 2.05 0.55; 1.2 1.0; 0.17 0.5 ]';
ke = zeros(16, 16);
be = zeros(3,16);
jac = quad8_bmat!(be, coord, xi);
check = [ 0.136181292323095	0	0.0219871518556113	0	0.251418301653295	0	0.0371087503650040	0	-0.163382788492290	0	0.480936357189538	0	-0.267669674763964	0	-0.496579390130289	0;
    0	0.341929386852701	0	0.272181324105765	0	0.503638619122441	0	0.177046853614981	0	-1.07391655857248	0	-0.923907321733983	0	1.15853791771864	0	-0.455510221108063;
    0.341929386852701	0.136181292323095	0.272181324105765	0.0219871518556113	0.503638619122441	0.251418301653295	0.177046853614981	0.0371087503650040	-1.07391655857248	-0.163382788492290	-0.923907321733983	0.480936357189538	1.15853791771864	-0.267669674763964	-0.455510221108063	-0.496579390130289];
print("b-matrix: ", norm(be-check),"\n")
print("b-matrix jac: ", norm(jac-0.402735200),"\n")
quad8_kmat!(ke, coord, cmat, thk);
check = [ 1452986.74745173	597752.029476168	756008.558091810	-65271.8644416589	779397.481287744	288484.072312693	818035.434890015	-93652.8645737235	-819573.469241498	-328130.379372286	-957781.334714524	-139643.384384080	-614072.948765903	-46865.6673048981	-1415000.46899938	-212671.941712215;
    597752.029476168	2700041.65596768	-88165.6373354316	1199244.26347245	288484.072312693	1396938.29229397	-70759.0916799509	1785442.90214839	-236555.287797195	353281.750002030	-139643.384384080	-2465060.26175738	-46865.6673048979	-437790.379271526	-304247.033287306	-4532098.22285562;
    756008.558091810	-88165.6373354316	2415548.17165044	-1068780.28259146	1043550.02554832	-40640.8103207381	1002626.41375063	-437458.959262629	-1030653.66834168	532559.931747967	-2253896.19006518	490359.783033663	-904339.211850962	364802.514976663	-1028844.09878338	247323.459751970;
    -65271.8644416589	1199244.26347245	-1068780.28259146	4736466.12714255	-63534.5832145108	2131346.33186820	-437458.959262629	1900339.77330539	440984.840172876	-98511.5454043846	581934.874608754	-6181904.50017096	364802.514976663	-947988.608425304	247323.459751970	-2738991.84178795;
    779397.481287744	288484.072312693	1043550.02554832	-63534.5832145108	2099355.00988189	866926.234726175	880954.925676079	-70733.0128598104	-753858.923226128	-192204.350807342	-2031727.25722966	-454512.610555185	-1009954.05495100	-206031.597402225	-1007717.20698724	-168394.152199795;
    288484.072312693	1396938.29229397	-40640.8103207382	2131346.33186820	866926.234726175	3630807.59941410	-93626.7857535831	1335890.10625299	-192204.350807342	-529658.002445638	-546087.702130277	-5514599.86960542	-114456.505827134	119720.047411206	-168394.152199795	-2570444.50518941;
    818035.434890015	-70759.0916799509	1002626.41375063	-437458.959262629	880954.925676079	-93626.7857535831	2218289.75915854	-1058766.78233577	-719619.269683667	242497.832660811	-1190819.92424717	290547.969511337	-1312619.94244533	663179.410680823	-1696847.39709911	464386.406178965;
    -93652.8645737235	1785442.90214839	-437458.959262629	1900339.77330539	-70733.0128598105	1335890.10625299	-1058766.78233577	4054104.81839957	242497.832660810	-598318.794550068	290547.969511337	-2874669.05023241	571604.319105731	-538541.418070309	555961.497754056	-5064248.33725356;
    -819573.469241498	-236555.287797195	-1030653.66834168	440984.840172876	-753858.923226128	-192204.350807342	-719619.269683667	242497.832660810	3493977.72949007	-433813.248272696	361435.471452084	-695647.200693209	79676.8103623456	-118404.394477023	-611384.680811526	993141.809213779;
    -328130.379372287	353281.750002031	532559.931747967	-98511.5454043846	-192204.350807342	-529658.002445638	242497.832660811	-598318.794550068	-433813.248272696	4220483.23530338	-695647.200693208	381520.650849123	-118404.394477023	-2671552.78358356	993141.809213778	-1057244.51017088;
    -957781.334714524	-139643.384384080	-2253896.19006518	581934.874608754	-2031727.25722966	-546087.702130277	-1190819.92424717	290547.969511337	361435.471452084	-695647.200693208	4689291.23811392	-81500.7753625906	198096.806422412	576702.818786520	1185401.19026812	13693.3996635447;
    -139643.384384080	-2465060.26175738	490359.783033663	-6181904.50017096	-454512.610555185	-5514599.86960542	290547.969511337	-2874669.05023241	-695647.200693209	381520.650849123	-81500.7753625906	11795256.9058003	576702.818786521	-128463.552144311	13693.3996635447	4987919.67726104;
    -614072.948765903	-46865.6673048979	-904339.211850962	364802.514976663	-1009954.05495100	-114456.505827134	-1312619.94244533	571604.319105731	79676.8103623455	-118404.394477023	198096.806422412	576702.818786521	3315530.78586960	-350526.960333085	247681.755358843	-882856.124926776;
    -46865.6673048981	-437790.379271526	364802.514976663	-947988.608425304	-206031.597402225	119720.047411206	663179.410680823	-538541.418070309	-118404.394477023	-2671552.78358356	576702.818786520	-128463.552144311	-350526.960333085	3905192.55756882	-882856.124926775	699424.136514985;
    -1415000.46899938	-304247.033287306	-1028844.09878338	247323.459751970	-1007717.20698724	-168394.152199795	-1696847.39709911	555961.497754056	-611384.680811526	993141.809213778	1185401.19026812	13693.3996635447	247681.755358843	-882856.124926775	4326710.90705366	-454622.855969473;
    -212671.941712215	-4532098.22285562	247323.459751970	-2738991.84178795	-168394.152199795	-2570444.50518941	464386.406178965	-5064248.33725356	993141.809213779	-1057244.51017088	13693.3996635447	4987919.67726104	-882856.124926776	699424.136514985	-454622.855969473	10275683.6034814];
print("k-matrix: ", norm(ke-check),"\n")

print("***** Validating TETRA4 ******\n")
coord = [0.0 0.0 0.0; 2.0 0.1 0.1; 0.2 1.0 0.0; 0.0 0.1 1.0]';
ke = zeros(12, 12);
be = zeros(6,12);
jac = tetra4_bmat!(be, coord);
check = [ -0.408678102926337	0	0	0.504540867810293	0	0	-0.0454086781029263	0	0	-0.0504540867810293	0	0;
0	-0.918264379414733	0	0	-0.100908173562059	0	0	1.00908173562059	0	0	0.0100908173562059	0;
0	0	-0.908173562058527	0	0	0.0100908173562059	0	0	-0.100908173562059	0	0	0.998990918264380;
-0.918264379414733	-0.408678102926337	0	-0.100908173562059	0.504540867810293	0	1.00908173562059	-0.0454086781029263	0	0.0100908173562059	-0.0504540867810293	0;
0	-0.908173562058527	-0.918264379414733	0	0.0100908173562059	-0.100908173562059	0	-0.100908173562059	1.00908173562059	0	0.998990918264380	0.0100908173562059;
-0.908173562058527	0	-0.408678102926337	0.0100908173562059	0	0.504540867810293	-0.100908173562059	0	-0.0454086781029263	0.998990918264380	0	-0.0504540867810293];
print("b-matrix: ", norm(be-check),"\n")
print("b-matrix jac: ", norm(jac-1.982000000000039),"\n")
cmat = mat1_cmat(E, nu);
tetra4_kmat!(ke, coord, cmat);
check = [2861894.87438232	1191977.80020184	1178879.14305676	-810823.048461813	-510039.069574902	-590021.734068164	-978307.976920509	-732942.637584428	130986.571450752	-1072763.84900000	51003.9069574902	-719843.980439353;
1191977.80020184	5009670.36663313	2648839.55600409	-830551.890087729	138425.315014622	98773.5775828631	-444481.099122884	-3980406.99630011	-987735.775828631	83055.1890087729	-1167688.68534764	-1759877.35775832;
1178879.14305676	2648839.55600409	4951130.68902181	-878483.272529708	162876.141685428	-184998.318197111	130986.571450752	-1628761.41685428	-746170.664182788	-431382.441977809	-1182954.28083523	-4019961.70664191;
-810823.048461813	-830551.890087729	-878483.272529707	1145049.03102282	-161711.816605866	16171.1816605866	-232541.592279236	976092.525033008	-97609.2525033008	-101684.390281769	16171.1816605866	959921.343372422;
-510039.069574902	138425.315014622	162876.141685428	-161711.816605866	368832.311314660	-3234.23633211733	655579.704520182	-483194.908018328	32342.3633211733	16171.1816605866	-24062.7183109529	-191984.268674484;
-590021.734068163	98773.5775828631	-184998.318197111	16171.1816605866	-3234.23633211733	336813.371626698	-65557.9704520182	32342.3633211733	-163005.511138713	639408.522859595	-127881.704571919	11190.4577091259;
-978307.976920509	-444481.099122884	130986.571450752	-232541.592279236	655579.704520182	-65557.9704520182	1315800.53817695	-145540.634945280	14554.0634945280	-104950.968977207	-65557.9704520182	-79982.6644932614;
-732942.637584428	-3980406.99630011	-1628761.41685428	976092.525033008	-483194.908018328	32342.3633211733	-145540.634945280	4543487.54172174	-323423.633211732	-97609.2525033008	-79885.6374032979	1919842.68674484;
130986.571450752	-987735.775828631	-746170.664182788	-97609.2525033008	32342.3633211733	-163005.511138713	14554.0634945280	-323423.633211732	1341593.57292559	-47931.3824419788	1278817.04571919	-432417.397604086;
-1072763.84900000	83055.1890087729	-431382.441977809	-101684.390281769	16171.1816605866	639408.522859595	-104950.968977207	-97609.2525033008	-47931.3824419787	1279399.20825897	-1617.11816605866	-160094.698439808;
51003.9069574902	-1167688.68534764	-1182954.28083523	16171.1816605866	-24062.7183109529	-127881.704571919	-65557.9704520182	-79885.6374032979	1278817.04571919	-1617.11816605866	1271637.04106189	32018.9396879615;
-719843.980439353	-1759877.35775832	-4019961.70664191	959921.343372422	-191984.268674484	11190.4577091260	-79982.6644932614	1919842.68674484	-432417.397604086	-160094.698439808	32018.9396879615	4441188.64653687];
print("k-matrix: ", norm(ke-check),"\n")

print("***** Validating TETRA10 ******\n")
coord = [  0    1.0000         0         0    0.5000    0.5000         0         0    0.5000    0.0;     
           0         0    1.0000         0         0    0.5000    0.5000         0         0    0.5000;
           0         0         0    1.0000         0         0         0    0.5000    0.5000    0.5000 ] ;
be = zeros(6,30);
ke = zeros(30, 30);
xi = [0.09, 0.10, 0.20];
jac = tetra10_bmat!(be, coord, xi);
check = [ -1.44000000000000	0	0	-0.640000000000000	0	0	0	0	0	0	0	0	2.08000000000000	0	0	0.400000000000000	0	0	-0.400000000000000	0	0	-0.800000000000000	0	0	0.800000000000000	0	0	0	0	0;
    0	-1.44000000000000	0	0	0	0	0	-0.600000000000000	0	0	0	0	0	-0.360000000000000	0	0	0.360000000000000	0	0	2.04000000000000	0	0	-0.800000000000000	0	0	0	0	0	0.800000000000000	0;
    0	0	-1.44000000000000	0	0	0	0	0	0	0	0	-0.200000000000000	0	0	-0.360000000000000	0	0	0	0	0	-0.400000000000000	0	0	1.64000000000000	0	0	0.360000000000000	0	0	0.400000000000000;
    -1.44000000000000	-1.44000000000000	0	0	-0.640000000000000	0	-0.600000000000000	0	0	0	0	0	-0.360000000000000	2.08000000000000	0	0.360000000000000	0.400000000000000	0	2.04000000000000	-0.400000000000000	0	-0.800000000000000	-0.800000000000000	0	0	0.800000000000000	0	0.800000000000000	0	0;
    0	-1.44000000000000	-1.44000000000000	0	0	0	0	0	-0.600000000000000	0	-0.200000000000000	0	0	-0.360000000000000	-0.360000000000000	0	0	0.360000000000000	0	-0.400000000000000	2.04000000000000	0	1.64000000000000	-0.800000000000000	0	0.360000000000000	0	0	0.400000000000000	0.800000000000000;
    -1.44000000000000	0	-1.44000000000000	0	0	-0.640000000000000	0	0	0	-0.200000000000000	0	0	-0.360000000000000	0	2.08000000000000	0	0	0.400000000000000	-0.400000000000000	0	-0.400000000000000	1.64000000000000	0	-0.800000000000000	0.360000000000000	0	0.800000000000000	0.400000000000000	0	0];
print("b-matrix: ", norm(be-check),"\n")
print("b-matrix jac: ", norm(jac-1.0),"\n")
tetra10_kmat!(ke, coord, cmat);
check = [2115384.65795632	961538.480889238	961538.480889238	448717.957748311	128205.130785232	128205.130785232	128205.130785232	192307.696177848	0	128205.130785232	0	192307.696177848	-2051282.09256371	-705128.219318775	-705128.219318775	576923.088533543	320512.826963079	128205.130785232	-1089743.61167447	-897435.915496622	-320512.826963079	-1089743.61167447	-320512.826963079	-897435.915496622	576923.088533543	128205.130785232	320512.826963079	256410.261570464	192307.696177848	192307.696177848;
961538.480889238	2115384.65795632	961538.480889238	192307.696177848	128205.130785232	0	128205.130785232	448717.957748311	128205.130785232	0	128205.130785232	192307.696177848	-897435.915496622	-1089743.61167447	-320512.826963079	320512.826963079	576923.088533543	128205.130785232	-705128.219318775	-2051282.09256371	-705128.219318775	-320512.826963079	-1089743.61167447	-897435.915496622	192307.696177848	256410.261570464	192307.696177848	128205.130785232	576923.088533543	320512.826963079;
961538.480889238	961538.480889238	2115384.65795632	192307.696177848	0	128205.130785232	0	192307.696177848	128205.130785232	128205.130785232	128205.130785232	448717.957748311	-897435.915496622	-320512.826963079	-1089743.61167447	192307.696177848	192307.696177848	256410.261570464	-320512.826963079	-897435.915496622	-1089743.61167447	-705128.219318775	-705128.219318775	-2051282.09256371	320512.826963079	128205.130785232	576923.088533543	128205.130785232	320512.826963079	576923.088533543;
448717.957748311	192307.696177848	192307.696177848	1346153.87324493	0	0	0	-192307.696177848	0	0	0	-192307.696177848	-1794871.83099324	-576923.088533543	-576923.088533543	-448717.957748311	576923.088533543	0	448717.957748311	0	192307.696177848	448717.957748311	192307.696177848	0	-448717.957748311	0	576923.088533543	0	-192307.696177848	-192307.696177848;
128205.130785232	128205.130785232	0	0	384615.392355695	0	-128205.130785232	0	0	0	0	0	-384615.392355695	-512820.523140927	0	384615.392355695	-128205.130785232	0	0	128205.130785232	0	128205.130785232	128205.130785232	0	0	-128205.130785232	0	-128205.130785232	0	0;
128205.130785232	0	128205.130785232	0	0	384615.392355695	0	0	0	-128205.130785232	0	0	-384615.392355695	0	-512820.523140927	0	0	-128205.130785232	128205.130785232	0	128205.130785232	0	0	128205.130785232	384615.392355695	0	-128205.130785232	-128205.130785232	0	0;
128205.130785232	128205.130785232	0	0	-128205.130785232	0	384615.392355695	0	0	0	0	0	128205.130785232	0	0	-128205.130785232	384615.392355695	0	-512820.523140927	-384615.392355695	0	128205.130785232	128205.130785232	0	0	-128205.130785232	0	-128205.130785232	0	0;
192307.696177848	448717.957748311	192307.696177848	-192307.696177848	0	0	0	1346153.87324493	0	0	0	-192307.696177848	0	448717.957748311	192307.696177848	576923.088533543	-448717.957748311	0	-576923.088533543	-1794871.83099324	-576923.088533543	192307.696177848	448717.957748311	0	-192307.696177848	0	-192307.696177848	0	-448717.957748311	576923.088533543;
0	128205.130785232	128205.130785232	0	0	0	0	0	384615.392355695	0	-128205.130785232	0	0	128205.130785232	128205.130785232	0	0	-128205.130785232	0	-384615.392355695	-512820.523140927	0	0	128205.130785232	0	-128205.130785232	0	0	384615.392355695	-128205.130785232;
128205.130785232	0	128205.130785232	0	0	-128205.130785232	0	0	0	384615.392355695	0	0	128205.130785232	0	0	0	0	-128205.130785232	128205.130785232	0	128205.130785232	-512820.523140927	0	-384615.392355695	-128205.130785232	0	384615.392355695	-128205.130785232	0	0;
0	128205.130785232	128205.130785232	0	0	0	0	0	-128205.130785232	0	384615.392355695	0	0	128205.130785232	128205.130785232	0	0	-128205.130785232	0	128205.130785232	0	0	-512820.523140927	-384615.392355695	0	-128205.130785232	0	0	-128205.130785232	384615.392355695;
192307.696177848	192307.696177848	448717.957748311	-192307.696177848	0	0	0	-192307.696177848	0	0	0	1346153.87324493	0	192307.696177848	448717.957748311	-192307.696177848	-192307.696177848	0	192307.696177848	0	448717.957748311	-576923.088533543	-576923.088533543	-1794871.83099324	576923.088533543	0	-448717.957748311	0	576923.088533543	-448717.957748311;
-2051282.09256371	-897435.915496622	-897435.915496622	-1794871.83099324	-384615.392355695	-384615.392355695	128205.130785232	0	0	128205.130785232	0	0	5641025.72874917	1282051.30785232	1282051.30785232	-1025641.03338134	-1282051.29495181	-512820.510240414	512820.510240414	1282051.29495181	512820.510240414	512820.510240414	512820.510240414	1282051.29495181	-1025641.03338134	-512820.510240414	-1282051.29495181	-1025641.02048083	0	0;
-705128.219318775	-1089743.61167447	-320512.826963079	-576923.088533543	-512820.523140927	0	0	448717.957748311	128205.130785232	0	128205.130785232	192307.696177848	1282051.30785232	5641025.69649789	2564102.58345335	-1282051.28850155	-3589743.61683470	-1025641.03338134	1282051.28850155	512820.510240414	769230.765360621	769230.765360621	1794871.78584145	512820.510240414	-769230.765360621	-1025641.03338134	-1538461.55007201	0	-2307692.29608186	-1282051.27560104;
-705128.219318775	-320512.826963079	-1089743.61167447	-576923.088533543	0	-512820.523140927	0	192307.696177848	128205.130785232	0	128205.130785232	448717.957748311	1282051.30785232	2564102.58345335	5641025.69649789	-769230.765360621	-1538461.55007201	-1025641.03338134	769230.765360621	512820.510240414	1794871.78584145	1282051.28850155	769230.765360621	512820.510240414	-1282051.28850155	-1025641.03338134	-3589743.61683470	0	-1282051.27560104	-2307692.29608186;
576923.088533543	320512.826963079	192307.696177848	-448717.957748311	384615.392355695	0	-128205.130785232	576923.088533543	0	0	0	-192307.696177848	-1025641.03338134	-1282051.28850155	-769230.765360621	4615384.65021604	1282051.27560104	0	-3589743.61683470	-1282051.29495181	-1538461.55007201	-2307692.29608186	-1282051.27560104	0	1794871.78584145	512820.510240414	769230.765360621	512820.510240414	769230.765360621	1538461.55007201;
320512.826963079	576923.088533543	192307.696177848	576923.088533543	-128205.130785232	0	384615.392355695	-448717.957748311	0	0	0	-192307.696177848	-1282051.29495181	-3589743.61683470	-1538461.55007201	1282051.27560104	4615384.65021604	0	-1282051.28850155	-1025641.03338134	-769230.765360621	-1282051.27560104	-2307692.29608186	0	769230.765360621	512820.510240414	1538461.55007201	512820.510240414	1794871.78584145	769230.765360621;
128205.130785232	128205.130785232	256410.261570464	0	0	-128205.130785232	0	0	-128205.130785232	-128205.130785232	-128205.130785232	0	-512820.510240414	-1025641.03338134	-1025641.03338134	0	0	2051282.06676268	-1025641.03338134	-512820.510240414	-1025641.03338134	0	0	-1025641.02048083	512820.510240414	1025641.03338134	512820.510240414	1025641.03338134	512820.510240414	512820.510240414;
-1089743.61167447	-705128.219318775	-320512.826963079	448717.957748311	0	128205.130785232	-512820.523140927	-576923.088533543	0	128205.130785232	0	192307.696177848	512820.510240414	1282051.28850155	769230.765360621	-3589743.61683470	-1282051.28850155	-1025641.03338134	5641025.69649789	1282051.30785232	2564102.58345335	1794871.78584145	769230.765360621	512820.510240414	-2307692.29608186	0	-1282051.27560104	-1025641.03338134	-769230.765360621	-1538461.55007201;
-897435.915496622	-2051282.09256371	-897435.915496622	0	128205.130785232	0	-384615.392355695	-1794871.83099324	-384615.392355695	0	128205.130785232	0	1282051.29495181	512820.510240414	512820.510240414	-1282051.29495181	-1025641.03338134	-512820.510240414	1282051.30785232	5641025.72874917	1282051.30785232	512820.510240414	512820.510240414	1282051.29495181	0	-1025641.02048083	0	-512820.510240414	-1025641.03338134	-1282051.29495181;
-320512.826963079	-705128.219318775	-1089743.61167447	192307.696177848	0	128205.130785232	0	-576923.088533543	-512820.523140927	128205.130785232	0	448717.957748311	512820.510240414	769230.765360621	1794871.78584145	-1538461.55007201	-769230.765360621	-1025641.03338134	2564102.58345335	1282051.30785232	5641025.69649789	769230.765360621	1282051.28850155	512820.510240414	-1282051.27560104	0	-2307692.29608186	-1025641.03338134	-1282051.28850155	-3589743.61683470;
-1089743.61167447	-320512.826963079	-705128.219318775	448717.957748311	128205.130785232	0	128205.130785232	192307.696177848	0	-512820.523140927	0	-576923.088533543	512820.510240414	769230.765360621	1282051.28850155	-2307692.29608186	-1282051.27560104	0	1794871.78584145	512820.510240414	769230.765360621	5641025.69649789	2564102.58345335	1282051.30785232	-3589743.61683470	-1025641.03338134	-1282051.28850155	-1025641.03338134	-1538461.55007201	-769230.765360621;
-320512.826963079	-1089743.61167447	-705128.219318775	192307.696177848	128205.130785232	0	128205.130785232	448717.957748311	0	0	-512820.523140927	-576923.088533543	512820.510240414	1794871.78584145	769230.765360621	-1282051.27560104	-2307692.29608186	0	769230.765360621	512820.510240414	1282051.28850155	2564102.58345335	5641025.69649789	1282051.30785232	-1538461.55007201	-1025641.03338134	-769230.765360621	-1025641.03338134	-3589743.61683470	-1282051.28850155;
-897435.915496622	-897435.915496622	-2051282.09256371	0	0	128205.130785232	0	0	128205.130785232	-384615.392355695	-384615.392355695	-1794871.83099324	1282051.29495181	512820.510240414	512820.510240414	0	0	-1025641.02048083	512820.510240414	1282051.29495181	512820.510240414	1282051.30785232	1282051.30785232	5641025.72874917	-1282051.29495180	-512820.510240414	-1025641.03338134	-512820.510240414	-1282051.29495180	-1025641.03338134;
576923.088533543	192307.696177848	320512.826963079	-448717.957748311	0	384615.392355695	0	-192307.696177848	0	-128205.130785232	0	576923.088533543	-1025641.03338134	-769230.765360621	-1282051.28850155	1794871.78584145	769230.765360621	512820.510240414	-2307692.29608186	0	-1282051.27560104	-3589743.61683470	-1538461.55007201	-1282051.29495180	4615384.65021604	0	1282051.27560104	512820.510240414	1538461.55007201	769230.765360621;
128205.130785232	256410.261570464	128205.130785232	0	-128205.130785232	0	-128205.130785232	0	-128205.130785232	0	-128205.130785232	0	-512820.510240414	-1025641.03338134	-1025641.03338134	512820.510240414	512820.510240414	1025641.03338134	0	-1025641.02048083	0	-1025641.03338134	-1025641.03338134	-512820.510240414	0	2051282.06676268	0	1025641.03338134	512820.510240414	512820.510240414;
320512.826963079	192307.696177848	576923.088533543	576923.088533543	0	-128205.130785232	0	-192307.696177848	0	384615.392355695	0	-448717.957748311	-1282051.29495181	-1538461.55007201	-3589743.61683470	769230.765360621	1538461.55007201	512820.510240414	-1282051.27560104	0	-2307692.29608186	-1282051.28850155	-769230.765360621	-1025641.03338134	1282051.27560104	0	4615384.65021604	512820.510240414	769230.765360621	1794871.78584145;
256410.261570464	128205.130785232	128205.130785232	0	-128205.130785232	-128205.130785232	-128205.130785232	0	0	-128205.130785232	0	0	-1025641.02048083	0	0	512820.510240414	512820.510240414	1025641.03338134	-1025641.03338134	-512820.510240414	-1025641.03338134	-1025641.03338134	-1025641.03338134	-512820.510240414	512820.510240414	1025641.03338134	512820.510240414	2051282.06676268	0	0;
192307.696177848	576923.088533543	320512.826963079	-192307.696177848	0	0	0	-448717.957748311	384615.392355695	0	-128205.130785232	576923.088533543	0	-2307692.29608186	-1282051.27560104	769230.765360621	1794871.78584145	512820.510240414	-769230.765360621	-1025641.03338134	-1282051.28850155	-1538461.55007201	-3589743.61683470	-1282051.29495180	1538461.55007201	512820.510240414	769230.765360621	0	4615384.65021604	1282051.27560104;
192307.696177848	320512.826963079	576923.088533543	-192307.696177848	0	0	0	576923.088533543	-128205.130785232	0	384615.392355695	-448717.957748311	0	-1282051.27560104	-2307692.29608186	1538461.55007201	769230.765360621	512820.510240414	-1538461.55007201	-1282051.29495181	-3589743.61683470	-769230.765360621	-1282051.28850155	-1025641.03338134	769230.765360621	512820.510240414	1794871.78584145	0	1282051.27560104	4615384.65021604];
print("k-matrix: ", norm(ke-check),"\n")

print("***** Validating HEXA8 ******\n")
coord = [0 0 0;2 0 0; 2 2 0; 0 2 0; 0 0 2; 2 0 2; 2 2 2; 0 2 2]';
be = zeros(6, 24);
ke = zeros(24, 24);
jac = hexa8_bmat!(be, coord, xi);
check = [-0.0900000000000000	0	0	0.0900000000000000	0	0	0.110000000000000	0	0	-0.110000000000000	0	0	-0.135000000000000	0	0	0.135000000000000	0	0	0.165000000000000	0	0	-0.165000000000000	0	0;
    0	-0.0910000000000000	0	0	-0.109000000000000	0	0	0.109000000000000	0	0	0.0910000000000000	0	0	-0.136500000000000	0	0	-0.163500000000000	0	0	0.163500000000000	0	0	0.136500000000000	0;
    0	0	-0.102375000000000	0	0	-0.122625000000000	0	0	-0.149875000000000	0	0	-0.125125000000000	0	0	0.102375000000000	0	0	0.122625000000000	0	0	0.149875000000000	0	0	0.125125000000000;
    -0.0910000000000000	-0.0900000000000000	0	-0.109000000000000	0.0900000000000000	0	0.109000000000000	0.110000000000000	0	0.0910000000000000	-0.110000000000000	0	-0.136500000000000	-0.135000000000000	0	-0.163500000000000	0.135000000000000	0	0.163500000000000	0.165000000000000	0	0.136500000000000	-0.165000000000000	0;
    0	-0.102375000000000	-0.0910000000000000	0	-0.122625000000000	-0.109000000000000	0	-0.149875000000000	0.109000000000000	0	-0.125125000000000	0.0910000000000000	0	0.102375000000000	-0.136500000000000	0	0.122625000000000	-0.163500000000000	0	0.149875000000000	0.163500000000000	0	0.125125000000000	0.136500000000000;
    -0.102375000000000	0	-0.0900000000000000	-0.122625000000000	0	0.0900000000000000	-0.149875000000000	0	0.110000000000000	-0.125125000000000	0	-0.110000000000000	0.102375000000000	0	-0.135000000000000	0.122625000000000	0	0.135000000000000	0.149875000000000	0	0.165000000000000	0.125125000000000	0	-0.165000000000000];
print("b-matrix: ", norm(be-check),"\n")
print("b-matrix jac: ", norm(jac-1.0),"\n")
hexa8_kmat!(ke, coord, cmat);
check = [4700854.70085473	1602564.10256411	1602564.10256411	-2136752.13675216	320512.820512822	320512.820512822	-1709401.70940171	-1602564.10256411	160256.410256409	1068376.06837606	-320512.820512822	801282.051282045	1068376.06837606	801282.051282045	-320512.820512822	-1709401.70940171	160256.410256409	-1602564.10256411	-1175213.67521366	-801282.051282045	-801282.051282045	-106837.606837615	-160256.410256409	-160256.410256409;
1602564.10256411	4700854.70085473	1602564.10256411	-320512.820512822	1068376.06837606	801282.051282045	-1602564.10256411	-1709401.70940171	160256.410256409	320512.820512822	-2136752.13675216	320512.820512822	801282.051282045	1068376.06837606	-320512.820512822	-160256.410256409	-106837.606837615	-160256.410256409	-801282.051282045	-1175213.67521366	-801282.051282045	160256.410256409	-1709401.70940171	-1602564.10256411;
1602564.10256411	1602564.10256411	4700854.70085473	-320512.820512822	801282.051282045	1068376.06837606	-160256.410256409	-160256.410256409	-106837.606837615	801282.051282045	-320512.820512822	1068376.06837606	320512.820512822	320512.820512822	-2136752.13675216	-1602564.10256411	160256.410256409	-1709401.70940171	-801282.051282045	-801282.051282045	-1175213.67521366	160256.410256409	-1602564.10256411	-1709401.70940171;
-2136752.13675216	-320512.820512822	-320512.820512822	4700854.70085473	-1602564.10256411	-1602564.10256411	1068376.06837606	320512.820512822	-801282.051282045	-1709401.70940171	1602564.10256411	-160256.410256409	-1709401.70940171	-160256.410256409	1602564.10256411	1068376.06837606	-801282.051282045	320512.820512822	-106837.606837615	160256.410256409	160256.410256409	-1175213.67521366	801282.051282045	801282.051282045;
320512.820512822	1068376.06837606	801282.051282045	-1602564.10256411	4700854.70085473	1602564.10256411	-320512.820512822	-2136752.13675216	320512.820512822	1602564.10256411	-1709401.70940171	160256.410256409	160256.410256409	-106837.606837615	-160256.410256409	-801282.051282045	1068376.06837606	-320512.820512822	-160256.410256409	-1709401.70940171	-1602564.10256411	801282.051282045	-1175213.67521366	-801282.051282045;
320512.820512822	801282.051282045	1068376.06837606	-1602564.10256411	1602564.10256411	4700854.70085473	-801282.051282045	-320512.820512822	1068376.06837606	160256.410256409	-160256.410256409	-106837.606837615	1602564.10256411	160256.410256409	-1709401.70940171	-320512.820512822	320512.820512822	-2136752.13675216	-160256.410256409	-1602564.10256411	-1709401.70940171	801282.051282045	-801282.051282045	-1175213.67521366;
-1709401.70940171	-1602564.10256411	-160256.410256409	1068376.06837606	-320512.820512822	-801282.051282045	4700854.70085473	1602564.10256411	-1602564.10256411	-2136752.13675216	320512.820512822	-320512.820512822	-1175213.67521366	-801282.051282045	801282.051282045	-106837.606837615	-160256.410256409	160256.410256409	1068376.06837606	801282.051282045	320512.820512822	-1709401.70940171	160256.410256409	1602564.10256411;
-1602564.10256411	-1709401.70940171	-160256.410256409	320512.820512822	-2136752.13675216	-320512.820512822	1602564.10256411	4700854.70085473	-1602564.10256411	-320512.820512822	1068376.06837606	-801282.051282045	-801282.051282045	-1175213.67521366	801282.051282045	160256.410256409	-1709401.70940171	1602564.10256411	801282.051282045	1068376.06837606	320512.820512822	-160256.410256409	-106837.606837615	160256.410256409;
160256.410256409	160256.410256409	-106837.606837615	-801282.051282045	320512.820512822	1068376.06837606	-1602564.10256411	-1602564.10256411	4700854.70085473	320512.820512821	-801282.051282045	1068376.06837606	801282.051282045	801282.051282045	-1175213.67521366	-160256.410256409	1602564.10256411	-1709401.70940171	-320512.820512822	-320512.820512822	-2136752.13675216	1602564.10256411	-160256.410256409	-1709401.70940171;
1068376.06837606	320512.820512822	801282.051282045	-1709401.70940171	1602564.10256411	160256.410256409	-2136752.13675216	-320512.820512822	320512.820512821	4700854.70085473	-1602564.10256411	1602564.10256411	-106837.606837615	160256.410256409	-160256.410256409	-1175213.67521366	801282.051282045	-801282.051282045	-1709401.70940171	-160256.410256409	-1602564.10256411	1068376.06837606	-801282.051282045	-320512.820512822;
-320512.820512822	-2136752.13675216	-320512.820512822	1602564.10256411	-1709401.70940171	-160256.410256409	320512.820512822	1068376.06837606	-801282.051282045	-1602564.10256411	4700854.70085473	-1602564.10256411	-160256.410256409	-1709401.70940171	1602564.10256411	801282.051282045	-1175213.67521366	801282.051282045	160256.410256409	-106837.606837615	160256.410256409	-801282.051282045	1068376.06837606	320512.820512822;
801282.051282045	320512.820512822	1068376.06837606	-160256.410256409	160256.410256409	-106837.606837615	-320512.820512822	-801282.051282045	1068376.06837606	1602564.10256411	-1602564.10256411	4700854.70085473	160256.410256409	1602564.10256411	-1709401.70940171	-801282.051282045	801282.051282045	-1175213.67521366	-1602564.10256411	-160256.410256409	-1709401.70940171	320512.820512822	-320512.820512822	-2136752.13675216;
1068376.06837606	801282.051282045	320512.820512822	-1709401.70940171	160256.410256409	1602564.10256411	-1175213.67521366	-801282.051282045	801282.051282045	-106837.606837615	-160256.410256409	160256.410256409	4700854.70085473	1602564.10256411	-1602564.10256411	-2136752.13675216	320512.820512821	-320512.820512822	-1709401.70940171	-1602564.10256411	-160256.410256409	1068376.06837606	-320512.820512822	-801282.051282045;
801282.051282045	1068376.06837606	320512.820512822	-160256.410256409	-106837.606837615	160256.410256409	-801282.051282045	-1175213.67521366	801282.051282045	160256.410256409	-1709401.70940171	1602564.10256411	1602564.10256411	4700854.70085473	-1602564.10256411	-320512.820512822	1068376.06837606	-801282.051282045	-1602564.10256411	-1709401.70940171	-160256.410256409	320512.820512822	-2136752.13675216	-320512.820512822;
-320512.820512822	-320512.820512822	-2136752.13675216	1602564.10256411	-160256.410256409	-1709401.70940171	801282.051282045	801282.051282045	-1175213.67521366	-160256.410256409	1602564.10256411	-1709401.70940171	-1602564.10256411	-1602564.10256411	4700854.70085473	320512.820512822	-801282.051282045	1068376.06837606	160256.410256409	160256.410256409	-106837.606837615	-801282.051282045	320512.820512822	1068376.06837606;
-1709401.70940171	-160256.410256409	-1602564.10256411	1068376.06837606	-801282.051282045	-320512.820512822	-106837.606837615	160256.410256409	-160256.410256409	-1175213.67521366	801282.051282045	-801282.051282045	-2136752.13675216	-320512.820512822	320512.820512822	4700854.70085473	-1602564.10256411	1602564.10256411	1068376.06837606	320512.820512822	801282.051282045	-1709401.70940171	1602564.10256411	160256.410256409;
160256.410256409	-106837.606837615	160256.410256409	-801282.051282045	1068376.06837606	320512.820512822	-160256.410256409	-1709401.70940171	1602564.10256411	801282.051282045	-1175213.67521366	801282.051282045	320512.820512821	1068376.06837606	-801282.051282045	-1602564.10256411	4700854.70085473	-1602564.10256411	-320512.820512822	-2136752.13675216	-320512.820512822	1602564.10256411	-1709401.70940171	-160256.410256409;
-1602564.10256411	-160256.410256409	-1709401.70940171	320512.820512822	-320512.820512822	-2136752.13675216	160256.410256409	1602564.10256411	-1709401.70940171	-801282.051282045	801282.051282045	-1175213.67521366	-320512.820512822	-801282.051282045	1068376.06837606	1602564.10256411	-1602564.10256411	4700854.70085473	801282.051282045	320512.820512822	1068376.06837606	-160256.410256409	160256.410256409	-106837.606837615;
-1175213.67521366	-801282.051282045	-801282.051282045	-106837.606837615	-160256.410256409	-160256.410256409	1068376.06837606	801282.051282045	-320512.820512822	-1709401.70940171	160256.410256409	-1602564.10256411	-1709401.70940171	-1602564.10256411	160256.410256409	1068376.06837606	-320512.820512822	801282.051282045	4700854.70085473	1602564.10256411	1602564.10256411	-2136752.13675216	320512.820512822	320512.820512822;
-801282.051282045	-1175213.67521366	-801282.051282045	160256.410256409	-1709401.70940171	-1602564.10256411	801282.051282045	1068376.06837606	-320512.820512822	-160256.410256409	-106837.606837615	-160256.410256409	-1602564.10256411	-1709401.70940171	160256.410256409	320512.820512822	-2136752.13675216	320512.820512822	1602564.10256411	4700854.70085473	1602564.10256411	-320512.820512822	1068376.06837606	801282.051282045;
-801282.051282045	-801282.051282045	-1175213.67521366	160256.410256409	-1602564.10256411	-1709401.70940171	320512.820512822	320512.820512822	-2136752.13675216	-1602564.10256411	160256.410256409	-1709401.70940171	-160256.410256409	-160256.410256409	-106837.606837615	801282.051282045	-320512.820512822	1068376.06837606	1602564.10256411	1602564.10256411	4700854.70085473	-320512.820512821	801282.051282045	1068376.06837606;
-106837.606837615	160256.410256409	160256.410256409	-1175213.67521366	801282.051282045	801282.051282045	-1709401.70940171	-160256.410256409	1602564.10256411	1068376.06837606	-801282.051282045	320512.820512822	1068376.06837606	320512.820512822	-801282.051282045	-1709401.70940171	1602564.10256411	-160256.410256409	-2136752.13675216	-320512.820512822	-320512.820512821	4700854.70085473	-1602564.10256411	-1602564.10256411;
-160256.410256409	-1709401.70940171	-1602564.10256411	801282.051282045	-1175213.67521366	-801282.051282045	160256.410256409	-106837.606837615	-160256.410256409	-801282.051282045	1068376.06837606	-320512.820512822	-320512.820512822	-2136752.13675216	320512.820512822	1602564.10256411	-1709401.70940171	160256.410256409	320512.820512822	1068376.06837606	801282.051282045	-1602564.10256411	4700854.70085473	1602564.10256411;
-160256.410256409	-1602564.10256411	-1709401.70940171	801282.051282045	-801282.051282045	-1175213.67521366	1602564.10256411	160256.410256409	-1709401.70940171	-320512.820512822	320512.820512822	-2136752.13675216	-801282.051282045	-320512.820512822	1068376.06837606	160256.410256409	-160256.410256409	-106837.606837615	320512.820512822	801282.051282045	1068376.06837606	-1602564.10256411	1602564.10256411	4700854.70085473];
print("k-matrix: ", norm(ke-check),"\n")

print("***** Validating HEXA20 ******\n")  
coord = [0 0 0; 2 0 0; 2 2 0; 0 2 0; 0 0 2; 2 0 2; 2 2 2; 0 2 2;
         0 1 0; 2 1 0; 1 2 0; 0 1 0; 0 1 2; 2 1 2; 1 2 2; 0 1 2;
         0 0 1; 2 0 1; 2 2 1; 0 2 1]';
be = zeros(6, 60);
ke = zeros(60, 60);
jac = hexa20_bmat!(be, coord, xi);
check = [0.133530894795317	0	0	-0.0670750363216820	0	0	-0.100921716092642	0	0	0.107573455260234	0	0	0.146213272369883	0	0	-0.0631434492778396	0	0	-0.0854656439620544	0	0	0.112057217331852	0	0	-0.0553798820613621	0	0	0.164550551234937	0	0	-0.00665173916759256	0	0	-0.175626527647210	0	0	-0.0830698230920433	0	0	0.246825826852406	0	0	-0.00997760875138896	0	0	-0.263439791470815	0	0	-0.216332279292368	0	0	0.149876420818734	0	0	0.263667720707632	0	0	-0.197211862233997	0	0;
    0	0.137616015725152	0	0	0.349282539953850	0	0	-0.0974861122980941	0	0	-0.302630800786258	0	0	0.151315400393129	0	0	0.357307794205624	0	0	-0.0813377916417400	0	0	-0.297112939065037	0	0	-0.339082129732502	0	0	-0.248405606358431	0	0	0.400116913084352	0	0	0.100589180411931	0	0	-0.508623194598752	0	0	-0.372608409537646	0	0	0.600175369626528	0	0	0.150883770617896	0	0	-0.220434492778395	0	0	-0.666464062900607	0	0	0.259565507221605	0	0	0.627333048457397	0;
    0	0	0.162776250000000	0	0	0.172901250000000	0	0	0.181348750000000	0	0	0.173923750000000	0	0	-0.0808762500000000	0	0	-0.0748012500000000	0	0	-0.0614487500000000	0	0	-0.0738237500000001	0	0	-0.223177500000000	0	0	-0.269775000000000	0	0	-0.272772500000000	0	0	-0.225225000000000	0	0	0.223177500000000	0	0	0.269775000000000	0	0	0.272772500000000	0	0	0.225225000000000	0	0	-0.0819000000000001	0	0	-0.0981000000000001	0	0	-0.119900000000000	0	0	-0.100100000000000;
    0.137616015725152	0.133530894795317	0	0.349282539953850	-0.0670750363216820	0	-0.0974861122980941	-0.100921716092642	0	-0.302630800786258	0.107573455260234	0	0.151315400393129	0.146213272369883	0	0.357307794205624	-0.0631434492778396	0	-0.0813377916417400	-0.0854656439620544	0	-0.297112939065037	0.112057217331852	0	-0.339082129732502	-0.0553798820613621	0	-0.248405606358431	0.164550551234937	0	0.400116913084352	-0.00665173916759256	0	0.100589180411931	-0.175626527647210	0	-0.508623194598752	-0.0830698230920433	0	-0.372608409537646	0.246825826852406	0	0.600175369626528	-0.00997760875138896	0	0.150883770617896	-0.263439791470815	0	-0.220434492778395	-0.216332279292368	0	-0.666464062900607	0.149876420818734	0	0.259565507221605	0.263667720707632	0	0.627333048457397	-0.197211862233997	0;
    0	0.162776250000000	0.137616015725152	0	0.172901250000000	0.349282539953850	0	0.181348750000000	-0.0974861122980941	0	0.173923750000000	-0.302630800786258	0	-0.0808762500000000	0.151315400393129	0	-0.0748012500000000	0.357307794205624	0	-0.0614487500000000	-0.0813377916417400	0	-0.0738237500000001	-0.297112939065037	0	-0.223177500000000	-0.339082129732502	0	-0.269775000000000	-0.248405606358431	0	-0.272772500000000	0.400116913084352	0	-0.225225000000000	0.100589180411931	0	0.223177500000000	-0.508623194598752	0	0.269775000000000	-0.372608409537646	0	0.272772500000000	0.600175369626528	0	0.225225000000000	0.150883770617896	0	-0.0819000000000001	-0.220434492778395	0	-0.0981000000000001	-0.666464062900607	0	-0.119900000000000	0.259565507221605	0	-0.100100000000000	0.627333048457397;
    0.162776250000000	0	0.133530894795317	0.172901250000000	0	-0.0670750363216820	0.181348750000000	0	-0.100921716092642	0.173923750000000	0	0.107573455260234	-0.0808762500000000	0	0.146213272369883	-0.0748012500000000	0	-0.0631434492778396	-0.0614487500000000	0	-0.0854656439620544	-0.0738237500000001	0	0.112057217331852	-0.223177500000000	0	-0.0553798820613621	-0.269775000000000	0	0.164550551234937	-0.272772500000000	0	-0.00665173916759256	-0.225225000000000	0	-0.175626527647210	0.223177500000000	0	-0.0830698230920433	0.269775000000000	0	0.246825826852406	0.272772500000000	0	-0.00997760875138896	0.225225000000000	0	-0.263439791470815	-0.0819000000000001	0	-0.216332279292368	-0.0981000000000001	0	0.149876420818734	-0.119900000000000	0	0.263667720707632	-0.100100000000000	0	-0.197211862233997];
print("b-matrix: ", norm(be-check),"\n")
print("b-matrix jac: ", norm(jac-0.58505),"\n")
hexa20_kmat!(ke, coord, cmat); 
check = [3770403.88805083	-1160549.68996143	-391737.891737881	12748282.2188700	-1949891.06753808	-85470.0854700840	8915703.03334970	-1659125.18853691	-213675.213675214	4693983.57633629	-2101558.57214678	56980.0569800603	3974694.15116461	-654642.198759827	-64102.5641025655	10777777.7777774	-1705840.45584041	-284900.284900289	7041645.71811596	-1829855.87397348;
-1160549.68996143	3602815.48516838	-391737.891737880	-1778950.89659791	8196162.22557382	551994.301994302	-1659125.18853691	5186861.06921388	-213675.213675213	-2272498.74308695	4469834.08748106	-580484.330484324	-654642.198759827	3456217.52974690	-64102.5641025654	-1641737.89173785	6183760.68376055	-324074.074074074	-1829855.87397348	3674166.24769555;
-391737.891737881	-391737.891737880	1542735.04273502	85470.0854700832	551994.301994301	5803418.80341866	-213675.213675216	-213675.213675216	3917378.91737880	-92592.5925925886	-559116.809116805	2619658.11965805	64102.5641025653	64102.5641025654	1398860.39886035	-284900.284900289	-388176.638176636	4709401.70940158	-498575.498575497	-498575.498575497;
12748282.2188700	-1778950.89659791	85470.0854700831	45262371.6153108	-6554502.14273721	391737.891737879	34087313.5579002	-4157868.27551515	-56980.0569800616	25414350.3555255	-3932342.16763611	213675.213675212	10777777.7777774	-1641737.89173785	284900.284900288	31692666.8103126	-5080472.35988398	64102.5641025654	24474358.9743579	-3059116.80911669;
-1949891.06753807	8196162.22557382	551994.301994301	-6554502.14273721	28143814.7908729	4522792.02279199	-3986928.10457498	17711831.7412430	409544.159544157	-3932342.16763611	11843280.9021040	149572.649572652	-1705840.45584041	6183760.68376055	388176.638176636	-5080472.35988398	16295631.9279844	235042.735042734	-2995014.24501413	11974358.9743586;
-85470.0854700840	551994.301994302	5803418.80341866	391737.891737879	4522792.02279199	22327838.8278382	92592.5925925875	730056.980056974	13574074.0740736	213675.213675214	277777.777777778	8958485.95848555	284900.284900288	324074.074074074	4709401.70940158	-64102.5641025653	-235042.735042733	14746845.7468453	548433.048433041	587606.837606827;
8915703.03334970	-1659125.18853691	-213675.213675216	34087313.5579002	-3986928.10457498	92592.5925925875	30465560.5832063	-1302999.83241146	-1994301.99430198	20676889.5592414	-3340874.81146290	85470.0854700824	7041645.71811596	-1829855.87397348	498575.498575497	24474358.9743579	-2995014.24501413	-548433.048433041	20114295.2907650	-1723018.26713582;
-1659125.18853691	5186861.06921388	-213675.213675216	-4157868.27551515	17711831.7412430	730056.980056974	-1302999.83241146	17477459.3598118	-1994301.99430198	-3169934.64052273	10908580.5262272	-551994.301994301	-1829855.87397348	3674166.24769555	498575.498575497	-3059116.80911669	11974358.9743586	-587606.837606827	-1723018.26713582	11048810.1223392;
-213675.213675214	-213675.213675214	3917378.91737880	-56980.0569800616	409544.159544157	13574074.0740736	-1994301.99430198	-1994301.99430198	14562678.0626776	-85470.0854700850	-551994.301994300	8168091.16809083	498575.498575497	498575.498575497	2642450.14245004	-484330.484330480	-587606.837606827	10215099.7150994	85470.0854700833	85470.0854700835;
4693983.57633629	-2272498.74308695	-92592.5925925886	25414350.3555255	-3932342.16763611	213675.213675214	20676889.5592414	-3169934.64052273	-85470.0854700851	28310804.6637441	-8121453.70968876	1994301.99430198	2099631.30551353	-1404181.33065190	548433.048433041	6216584.06952496	-273977.112212373	-498575.498575498	4998491.70437383	-627828.054298615;
-2101558.57214678	4469834.08748106	-559116.809116805	-3932342.16763611	11843280.9021040	277777.777777778	-3340874.81146290	10908580.5262272	-551994.301994300	-8121453.70968876	17602504.2495625	-2136752.13675213	-1340078.76654934	1948801.74291935	445156.695156693	-273977.112212373	2424746.82180555	605413.105413106	-691930.618401176	4206636.50075407;
56980.0569800602	-580484.330484324	2619658.11965805	213675.213675212	149572.649572652	8958485.95848555	85470.0854700824	-551994.301994301	8168091.16809083	1994301.99430198	-2136752.13675213	12213878.7138782	484330.484330480	445156.695156695	1012820.51282047	-498575.498575498	605413.105413106	2285917.78591770	142450.142450140	103276.353276356;
3974694.15116461	-654642.198759827	64102.5641025653	10777777.7777774	-1705840.45584041	284900.284900288	7041645.71811596	-1829855.87397348	498575.498575497	2099631.30551353	-1340078.76654934	484330.484330480	3770403.88805082	-1160549.68996143	391737.891737881	12748282.2188700	-1949891.06753807	85470.0854700837	8915703.03334970	-1659125.18853691;
-654642.198759827	3456217.52974690	64102.5641025654	-1641737.89173785	6183760.68376055	324074.074074074	-1829855.87397348	3674166.24769555	498575.498575497	-1404181.33065190	1948801.74291935	445156.695156695	-1160549.68996143	3602815.48516838	391737.891737881	-1778950.89659791	8196162.22557382	-551994.301994301	-1659125.18853691	5186861.06921388;
-64102.5641025655	-64102.5641025654	1398860.39886035	284900.284900288	388176.638176636	4709401.70940158	498575.498575497	498575.498575497	2642450.14245004	548433.048433040	445156.695156693	1012820.51282047	391737.891737880	391737.891737880	1542735.04273502	-85470.0854700835	-551994.301994301	5803418.80341866	213675.213675216	213675.213675216;
10777777.7777774	-1641737.89173785	-284900.284900289	31692666.8103126	-5080472.35988398	-64102.5641025653	24474358.9743579	-3059116.80911669	-484330.484330480	6216584.06952496	-273977.112212373	-498575.498575498	12748282.2188700	-1778950.89659791	-85470.0854700836	45262371.6153108	-6554502.14273721	-391737.891737879	34087313.5579002	-4157868.27551514;
-1705840.45584041	6183760.68376055	-388176.638176636	-5080472.35988398	16295631.9279844	-235042.735042733	-2995014.24501413	11974358.9743586	-587606.837606827	-273977.112212373	2424746.82180555	605413.105413106	-1949891.06753807	8196162.22557382	-551994.301994301	-6554502.14273722	28143814.7908729	-4522792.02279198	-3986928.10457498	17711831.7412430;
-284900.284900289	-324074.074074074	4709401.70940158	64102.5641025655	235042.735042734	14746845.7468453	-548433.048433041	-587606.837606827	10215099.7150994	-498575.498575498	605413.105413106	2285917.78591770	85470.0854700836	-551994.301994301	5803418.80341866	-391737.891737879	-4522792.02279198	22327838.8278382	-92592.5925925871	-730056.980056973;
7041645.71811596	-1829855.87397348	-498575.498575497	24474358.9743579	-2995014.24501413	548433.048433041	20114295.2907650	-1723018.26713582	85470.0854700833	4998491.70437383	-691930.618401176	142450.142450140	8915703.03334970	-1659125.18853691	213675.213675216	34087313.5579002	-3986928.10457498	-92592.5925925873	30465560.5832063	-1302999.83241146;
-1829855.87397348	3674166.24769555	-498575.498575497	-3059116.80911669	11974358.9743586	587606.837606827	-1723018.26713582	11048810.1223392	85470.0854700835	-627828.054298615	4206636.50075407	103276.353276356	-1659125.18853691	5186861.06921388	213675.213675216	-4157868.27551514	17711831.7412430	-730056.980056973	-1302999.83241146	17477459.3598118];
print("k-matrix: ", norm(ke[1:20,1:20]-check),"\n")
